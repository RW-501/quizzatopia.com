<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" /> <!-- Character encoding for the webpage -->
<meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- Required for Internet Explorer compatibility -->

<!-- Metadata for search engines -->
<title>Quiz | Quizzatopia - Explore a World of Quizzes</title>
<meta name="generator" content="Quizzatopia" /> 
	
<meta name="description" content=" Discover a world of quizzes like never before, ranging from fun trivia to professional exam preparation.">

	<meta itemprop="name" content="Quizzatopia">
<meta property="og:title" content="Quizzatopia - Explore a World of Quizzes">
<meta property="og:image" content="https://www.quizzatopia.com/images/logo.png">
<meta name="Distribution" content="Global" />
<meta name="Rating" content="General" />
<meta name="copyright" content="Quizzatopia">
<meta name="language" content="English">
<meta name="reply-to" content="quizzatopia@gmail.com">
<meta name="generator" content="Adobe Dreamweaver">
<meta name="Developer" content="Ron Wilson II">
<!-- Links to favicon images for various devices -->
<link rel="icon" sizes="192x192" href="/favicon.ico">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="icon" type="image/x-icon" href="/favicon.ico"> <!-- Alternate link to favicon image -->
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" /> <!-- Required for mobile devices -->
<meta property="og:type" content="website">

	
<meta property="og:description" content="Welcome to Quizzatopia - the ultimate destination for all your quizzing needs. Discover a world of quizzes like never before, ranging from fun trivia to professional exam preparation. With our user-friendly interface and extensive question bank, learning has never been more enjoyable. Join now to compete with others, earn points, and unlock achievements. Sign up, log in, and embark on your quizzing journey today!">
<meta name="keywords" content="quizzing, quizzes, learning, education, fun, trivia, exam preparation, sign up, log in, compete, points, achievements">
<meta property="og:url" content="https://www.quizzatopia.com">

	
<meta name="robots" content="index,follow">
	<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@Quizzatopia">
<meta name="twitter:title" content="Quizzatopia - Explore a World of Quizzes">
<meta name="twitter:description" content="Welcome to Quizzatopia - the ultimate destination for all your quizzing needs. Discover a world of quizzes like never before, ranging from fun trivia to professional exam preparation. With our user-friendly interface and extensive question bank, learning has never been more enjoyable. Join now to compete with others, earn points, and unlock achievements. Sign up, log in, and embark on your quizzing journey today!">
<meta name="twitter:image" content="https://www.quizzatopia.com/images/logo.png">
<meta name="twitter:url" content="https://www.quizzatopia.com">

<!-- Open Graph metadata for Facebook -->
<meta property="og:site_name" content="Quizzatopia">
<meta property="og:locale" content="en_US">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Schema.org markup for Google+ -->
<meta itemprop="description" content="Welcome to Quizzatopia - the ultimate destination for all your quizzing needs. Discover a world of quizzes like never before, ranging from fun trivia to professional exam preparation. With our user-friendly interface and extensive question bank, learning has never been more enjoyable. Join now to compete with others, earn points, and unlock achievements. Sign up, log in, and embark on your quizzing journey today!">
<meta itemprop="image" content="https://www.quizzatopia.com/images/logo.png">


<!-- Canonical URL -->
<!-- <link rel="canonical" href="https://www.quizzatopia.com/quiz"> -->
 <link rel="canonical" href="https://www.quizzatopia.com/quiz/">

	
<!-- Author information -->
<meta name="author" content="Ron Wilson II">
<meta name="contact" content="quizzatopia@gmail.com">

<!-- Page-specific metadata -->
<meta name="subject" content="Quizzatopia Platform">
<meta name="topic" content="Quizzing, Education, Learning, Quizzes">
<meta name="geo.placename" content="Dallas, TX">
<meta name="geo.region" content="US-TX">

<!-- Language and content type -->
<meta name="content-language" content="en-US">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<!-- Caching and expiration -->
<meta http-equiv="expires" content="Tue, 01 Jan 2024 00:00:00 GMT">
<!-- <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="pragma" content="no-cache"> -->
	

 <!-- Google AdSense code -->
 <!--  <script defer  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4968673576211489" crossorigin="anonymous"></script> -->

 <!-- Organization Schema -->
   <script type="application/ld+json">
  {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Quizzatopia",
  "description": "Quizzatopia is an online platform dedicated to providing a diverse range of quizzes for individuals of all ages and backgrounds.",
  "url": "https://www.quizzatopia.com",
  "logo": "https://www.quizzatopia.com/images/logo.png",
  "sameAs": [
    "https://twitter.com/Quizzatopia",
    "https://www.facebook.com/Quizzatopia",
    "https://www.linkedin.com/company/quizzatopia",
    "https://www.reddit.com/r/Quizzatopia",
    "https://www.youtube.com/@Quizzatopia/about",
    "https://www.tiktok.com/@quizzatopia",
    "https://www.instagram.com/Quizzatopia"
  ]
}
 </script>



    <!-- Blog Schema -->
<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Blog",
        "name": "Quizzatopia Blog",
        "description": "The official blog of Quizzatopia, providing additional quiz-related content and insights.",
        "url": "https://quizzatopia.blogspot.com"
    }
 </script>

  

	  
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Quizzatopia",
  "url": "https://www.quizzatopia.com",
  "description": "Quizzatopia is an online platform dedicated to providing a diverse range of quizzes for individuals of all ages and backgrounds.",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.quizzatopia.com/quiz?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "sameAs": [
    "https://twitter.com/Quizzatopia",
    "https://www.facebook.com/Quizzatopia",
    "https://www.linkedin.com/company/quizzatopia",
    "https://www.reddit.com/r/Quizzatopia",
    "https://www.youtube.com/@Quizzatopia",
    "https://www.tiktok.com/@quizzatopia",
    "https://www.instagram.com/Quizzatopia"
  ]
}
</script>


	  
	  
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://www.quizzatopia.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Quizzes",
      "item": "https://www.quizzatopia.com/quizzes"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "About",
      "item": "https://www.quizzatopia.com/about"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "Quiz",
      "item": "https://www.quizzatopia.com/quiz"
    }
  ]
}
</script>

	<style>





		
.btnMain {
    background-color: #fd7e14;
    color: #fff;
    border: none;
    padding: 2%;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: 700;
	box-shadow: 0px 1px 0rem 2px rgba(0, 0, 0, 0.2) !important;
}



		
@keyframes blinkAnimation {
  0% {
    background-color: #eaeaea;
  }
  50% {
    background-color: #ffc107;
  }
  100% {
    background-color: #eaeaea;
  }
}

.blink{
  animation: blinkAnimation 1s infinite;
}



		
.game-button {
        display: inline-block;
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        text-decoration: none;
        font-family: "Arial", sans-serif;
        font-size: 18px;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s;
	    border: 1px solid #CED4DA;
    border-radius: 4px;
      }

      .game-button:hover {
        background-color: #45a049;
      }

      .share-link-container {
        display: flex;
        align-items: center;
      }

      .share-link-input {
    flex-grow: 1;
    padding: 2%;
    font-family: "Arial", sans-serif;
    font-size: 1.5em;
    border: none;
    width: 100%;
    border-radius: 4px;
    margin-bottom: 0 !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

      .copy-button {
        margin-left: 10px;
      }
#quiz-options{
    background-color: #eaeaea;
    box-shadow: 0px 1px 0rem 1px rgba(0, 0, 0, 0.2) !important;
    width: 100%;
    border-radius: 2em;
    margin-bottom: 5% !important;
    padding: 1%;
}

.font-weight-bold{
    display: inline-block;
    cursor: pointer;
    padding: 2%;
    margin-block-start: auto;
    color: #fd7e14;
    font-size: 1.2em;
    font-weight: 900;
}

		
		
.btnMainBottom {
display: inline-block;
    cursor: pointer;
    padding: 2%;
    margin-block-start: auto;
    background-color: #eaeaea;
    border-radius: 2em;
    box-shadow: 0px 1px 0rem 1px rgba(0, 0, 0, 0.2) !important;
    color: #fd7e14;
    font-size: 1.2em;
    font-weight: 900;
}


		
.popupMSG {
position: fixed;
    bottom: 0;
    left: 50%;
    min-width: 50%;
    transform: translate(-50%, -50%);
    background-color: #f9f9f9;
    padding: 10px;
    border: 1px solid #ccc;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    z-index: 9999;
	  display: none;

}

.popupMSG span {
  display: block;
  text-align: center;
}


		.rating {
  font-size: 30px;
}

.star {
  cursor: pointer;
  color: #ccc;
}

.star.active {
  color: #ffd700;
}

#quizRating {
    font-weight: 500;
    padding: 10px 20px;
    font-size: 20px;

}
.modal {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.6);
}

.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 400px;
  max-width: 90%;
}

.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.close:hover,
.close:focus {
  color: #333;
  text-decoration: none;
  cursor: pointer;
}

#reviewTextArea {
  width: 100%;
  height: 150px;
  margin-bottom: 10px;
  resize: none;
}

#submitReviewBtn {
  background-color: #4caf50;
  border: none;
  color: white;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}
.bar{
  width: 100%;
  padding: 5%;
	display:block;

}
#reportFormBTN{
  background-color: #ef6a6a;
  border: none;
  color: white;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
	display: block;
}

#endReviewBtn{
    font-size: 1.2em;
    font-weight: 900;
	display:block;
	  margin:  auto;
	  vertical-align: middle;
}


#question {
    padding: 4%  !important; 
}

#optionContainers {
    padding: 4%  !important;

}

#optionContainersXX {
     background-color: #f7ede1;
    border-radius: 2em;
    padding: 4%  !important;
    box-shadow: 0px 1px 0rem 2px rgba(0, 0, 0, 0.2) !important;
}

	#readButton {
    display: inline-block;
    cursor: pointer;
    padding: 10px;
    background-color: #eaeaea;
    border-radius: 5px;
        box-shadow: 0px 1px 0rem 1px rgba(0, 0, 0, 0.2) !important;
    color: #fd7e14;
    font-size: 1.2em;
    font-weight: 900;
		padding: 0 4% 0 4%;
}	

#readButton img {
  width: 24px;
  height: 24px;
  vertical-align: middle;
  margin-right: 5px;
}

#readButton span {
  font-size: 1.2em;
  vertical-align: middle;
color: #fd7e14;
}


	
#question-number {
display: inline-block;
    cursor: pointer;
    padding: 2%;
    margin-block-start: auto;
    background-color: #eaeaea;
    border-radius: 2em;
    box-shadow: 0px 1px 0rem 1px rgba(0, 0, 0, 0.2) !important;
    color: #fd7e14;
    font-size: 1.2em;
    font-weight: 900;
}


		#reviewPopup{
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;  right: 0;
  bottom: 0;		
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.6);
		}

		#reviewPopupBox{
  background-color: #fefefe;
  margin:  auto;
  padding: 20px;
  border: 1px solid #888;
  max-width: 90%;
		}

#statsPopup{
	  display: none;

}

		

		#questionPopup{
    display: none;



		}
.popup {
  position: fixed;
  left: 0;
  top: 0;  right: 0;
  bottom: 0;	
  width: 100%;     margin: auto;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
	    z-index: 999999;
}

.popup-content {
  position: absolute;
  left: 0;
  top: 0;  right: 0;
  bottom: 0;	
  width: 80%;

	    height: 90%;


		    background-color: #e7e7e7;
    padding: 5%;
    border-radius: 2em;
    margin: auto;
  overflow: hidden;

    box-shadow: inset 0px 1px 0rem 14px #fd7e14 !important;

}
#quizReviewName{
    text-align: center;
    width: 100%;
    display: block;
}
		
.scroll {
    overflow-y: scroll;
    display: block;
    height: 65%;
}
.tab {
    margin-top: 5%;

  display: flex;
  justify-content: center;
		display:none;

}

.tab-link {
  margin-right: 10px;
  padding: 8px 12px;
  border: none;
  background-color: #ccc;
  cursor: pointer;
}

.tab-link.active {
  background-color: #555;
  color: #fff;
}

.tab-cont {
  display: none;
  margin-top: 20px;
}

.tab-cont.active {
display: block !important;
}

#optionsPopup{
  display: none;

}
  #pie-chart_1{
    margin: auto;

  }


		#content-wrap {
    overflow-y: scroll;
    height: 85%;
}
		#reviewTop {
    display: flex;
    width: 100%;
    justify-content: space-evenly;
    font-size: 1.2em;
}





		/* Styling for the button */
#chell_list {

    padding: 5%
}

/* Styling for the popover container */
#popoverContent {
	    z-index: 9999999;
  display: none;

}

/* Styling for the tab navigation */
ul.nav-tabs {
  border-bottom: 1px solid #ccc;
  margin-bottom: 15px;
}

ul.nav-tabs li.nav-item {
  margin: 0;
}

ul.nav-tabs li.nav-item a.nav-link {
  padding: 10px 15px;
  color: #fd7e14;
  border: none;
  border-radius: 0;
}

ul.nav-tabs li.nav-item a.nav-link.active {
    background-color: #fd7e14;
    color: #fff;
}

/* Styling for the tab content */
.tab-content .tab-pane {
  padding: 15px 0;
}

/* Styling for the input field */
#quizLink {
  width: 100%;
  padding: 5px;
  margin-bottom: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
}

/* Styling for the copy link button */
#copyLinkButton {
  display: block;
  width: 100%;
  padding: 10px;
  background-color: #fd7e14;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

/* Styling for the friends list */
#friendsList {
  list-style: none;
  padding: 0;
  margin: 0;
}

#friendsList li {
  margin-bottom: 5px;
}

/* Styling for the Facebook share button */
#facebookShareButton {
  display: block;
  width: 100%;
  padding: 10px;
  background-color: #007bff;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}


		.attempts-container {
  display: flex;
  align-items: center;
}

.stars {
  font-size: 2.5em;
font-weight: 800;
}

.filled-star {
  color: gold;
}

.empty-star {
  color: gray;
}

.attempts-text {
  margin-left: 10px;
}

		.attempts-container {
    display: block;
    font-size: 1.5em;
			cursor: pointer;
}

#challengeBTN{
    margin-top: 20px;
    background-color: #fd7e14;
    border: none;
    margin-bottom: 15%;
    font-size: calc(1rem + 2vw);
    font-weight: 600;
    padding: 2%;
    color: white;
    border-radius: 1em;
    text-shadow: -4px 2px 0px #6b6a6a;
    box-shadow: 3px 3px 0rem 3px #b98c03 !important;
    cursor: pointer;
	text-align: center;
}
.topTitles{
	text-align: center;
    font-size: calc(1rem + 2vw);
    font-weight: 600;
    background-color: #fd7e14;
    width: 100%;
    padding: 2%;

}
.recommendedQuizzes-column a {
    color: #636669;
    text-decoration: none !important;
}

.recommendedQuizzes-column li {

    font-size: 1.2em;
    font-weight: 800;
    padding: 1%;
    margin: 1%;

}




.option_ad{
box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 20px;
		    width: 100%;
	text-align: center;
  margin: auto;
	margin-top: 5%;
}
.option_ad img{
	dispay:block;
		    width: 50%;
	text-align: center;
  margin: auto;
	    padding: 25% 0;
}


#challengeInfo{
	text-align: center;
  margin: auto;
	font-weight: 900;
}
		#challengeInfo p{
    width: 90%;
    margin: auto;
		}
.wrap {
    margin: auto;
    margin-top: 5%;
    overflow-y: auto;
    margin-right: 3%;
    height: inherit;
		    padding: 2%;

}
		.box{
    width: 100%;
    display: flex;
}
		#startChallengeBtn{
    margin: auto;
    width: fit-content;
    margin-top: 20px;
    background-color: #fd7e14;
    border: none;
    height: fit-content;
			    font-size: calc(1.3rem + 2.6vw);
    font-weight: 800;
    padding: 4%;
    color: white;
    border-radius: 1em;
    text-shadow: -4px 2px 0px #6b6a6a;
    box-shadow: 3px 3px 0rem 3px #b98c03 !important;
    cursor: pointer;
		}

.challenge-details {

}

.challenge-title {
  font-size: 24px;
  margin: 0;
}

.challenge-meta {
  margin-top: 10px;
}

.meta-label {
  font-weight: bold;
  color: #777;
}

.divider {
  margin-top: 15px;
  margin-bottom: 15px;
  border: none;
  border-top: 1px solid #ddd;
}

.challenge-description {
  color: #444;
  font-size: 16px;
}

/* You can further style the buttons, fonts, and layout as per your design */

	.list-catergory{
    font-weight: 800;
    font-size: 1.5em;
    margin-bottom: 10px;
    color: #fd7e14;

	}


		    section {
      margin: 20px;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
	        display: flex;
    justify-content: space-between;
    }
    section h2 {
    cursor: pointer;

    }
</style>
	  	
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4968673576211489"
     crossorigin="anonymous"></script>
	
	
  <!-- Chart.js library   background-color: yellow; -->
  <script  src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">

  <!-- Custom CSS -->
 <!--  <link rel="stylesheet" href="/style.css">-->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="indexOptions.css?21">
  <link rel="stylesheet" href="popupsCSS.css">

  <!-- Import navbar and footer components -->
  <link rel="import" href="/elements/navbar.html">
  <link rel="import" href="/elements/footer.html">

  <div id="navbar"></div>
  <!-- Rest of the page content -->
  <div id="signupLoginArea"><div>

  <!-- JavaScript dependencies async -->


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"  crossorigin="anonymous">


  <script  defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.3/umd/popper.min.js"></script>

  <script  defer src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>

	  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
	  <script  defer src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/js/bootstrap.min.js"></script>

<!-- Add this in the <head> section of your HTML -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Firebase SDK -->
  <script  src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script  src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script  src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

  <!-- Custom scripts   <script  src="/main.js" defer></script> 
-->
  <script  src="/main.js" ></script> 

  </head>
	  <!-- Google Tag Manager -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9VG78SV9KZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-9VG78SV9KZ');
	  
	//  console.log('page loading??/ mmmmm???????????????????????????????:');

function backButton(){
  window.history.back();

}


	  
  </script>

  <!-- Google AdSense -->

	
<body>
	<main_section>
  <!-- Rest of the page content -->

  <div id="optionContainer" >
	<section>
 <div><h2 id="back" class="list-catergory" onclick="backButton()">Back</h2>  </div> 

	</section>  
    <div class="row" style="padding: 2%;">
      <div class="col-md-6">
        <div class="quiz-options">
          <div class="form-check">
            <div id="optionsQuizNameWrap">
              <div id="optionsQuizName" class="text-center mb-4"><h1><div class="loading_Main ">Loading...</div>
</h1></div>
              <!-- Quiz Name -->
            </div>
          </div>
          <hr>





		

		
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="timer-checkbox">
            <label class="form-check-label" for="timer-checkbox">
              Enable Timer
            </label>
            <!-- Enable Timer Checkbox -->
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="countdown-per-question">
            <label class="form-check-label" for="countdown-per-question">
              Countdown per Question
            </label>
            <!-- Countdown per Question Checkbox -->
          </div>
          <div id="timer-timeGroup" class="form-group">
            <label for="quiz-time">Quiz Time:</label>
            <div class="input-group">
              <input type="number" id="quiz-time" name="quiz-time" value="30" class="form-control">
              <div class="input-group-append">
                <span class="input-group-text">Seconds</span>
              </div>
            </div>
            <!-- Quiz Time Input -->
          </div>

          <hr>

          <div id="testInfo" class="text-center mb-4"></div>
          <!-- Test Information Placeholder -->
          
          <p id="pie_graph_front" style=" margin: auto;"></p>
          <!-- Pie graph -->

             <div class="text-center">
            <button id="start-btn" class=" " onclick="startQuiz()" disabled>Start Quiz</button><br>


		     
            <div class="quiz-image-container text-center">
              <img src="/images/lan/9.png" alt="quiz-image" class="w-100" loading="lazy">
              <!-- Quiz Image -->
            </div>
            <button id="challengeBTN" class=" " onclick="startChallegeFunc()" >Start Challenge</button><br>

		     
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="quiz-image-container text-center">
          <img src="/images/lan/10.png" alt="quiz-image" class="w-100 d-md-block" loading="lazy">
          <!-- Quiz Image -->


		
        </div>






	      
	        <div class="container" style="padding: 2%;" loading="lazy">

	                    <h2 class="coach-name">Join the Discussion</h2>
		


<div id="discussionContainer" class="container" style="padding: 2%;" loading="lazy">
  <img src="https://www.quizzatopia.com/images/sq/43.png" alt="Main Discussion Picture" style="width: -webkit-fill-available;" loading="lazy">
  <p class="coach-description">A place where new members can introduce themselves, ask questions, and get acquainted with the Quizzatopia community.<br> <b>Join our community<b></b></b></p>
</div>

           <div class="option_ad"> <a href="https://www.buymeacoffee.com/Quizzatopia" target="_blank"><img src="/images/bmc.png" alt="Buy Me A Coffee" ></a>
	   </div>
</div>
	      
</div></div></div>
	
	
  <div class="container mt-4 d-none" id="quiz-container">
    <!-- Quiz Container -->

        <div id="quiz-options" class="d-flex justify-content-between">
<div id="statsBTN" class="font-weight-bold" onclick="openStatsFunc(); openPopupsFunc('statsPopup','statsPopupBox');">Stats</div>
<div id="reviewBTN" class="font-weight-bold" onclick="openReviewFunc(false); openPopupsFunc('reviewPopup','reviewPopupBox');">Review</div>
<div id="optionsBTN" class="font-weight-bold" onclick="openOptionsFunc(); openPopupsFunc('optionsPopup','optionsPopupBox');">Options</div>
	</div>

	  
    <div   id="quizContainer" class="layer-1">
      <!-- First Layer -->
      <div class="layer-2" id="quiz_main_area">
        <!-- Second Layer: Main Quiz Area -->
        <div id="ad-container">
          <!-- Ad Container -->
          <div id="ad-box">
          <!--     
            <p>
		  
<a href="https://www.buymeacoffee.com/Quizzatopia" target="_blank"><img src="/images/bmc.png" alt="Buy Me A Coffee"  id="adPic" ></a>

            </p>-->
            <div id='ad-view' style="min-width:255px">
            <!--   <span id='ad-text'></span> -->
<!-- frontpage_bottom_1 -->
<ins class="adsbygoogle"
     style="display:block; width:100%;  "
     data-ad-client="ca-pub-4968673576211489"
     data-ad-slot="4063180774"
     data-ad-format="video"
     data-full-width-responsive="true"></ins>



		    
              <!-- Google Ad Code -->
              <!-- <span class='ad-text'>This will be an ad</span> -->
            </div>
          </div>
        </div>

	      
	
	
        <div id="quiz-timer-qn" class="d-flex justify-content-between">
          <div id="question-number" class="font-weight-bold"   onclick="openStatsFunc(); openPopupsFunc('statsPopup','statsPopupBox');"></div>
          <div id="timer" class="text-right"></div>
		
<div id="readButton" onclick="readQuizFunc();">
  <div>&#128264;</div>
  <span>Read</span>
</div>
		
        </div>

        <div class="progress-bar-container">
          <!-- Progress Bar Container -->
          <div class="progress-bar" id="progress-bar"></div>
          <!-- Progress Bar -->
        </div>

	      
	
        <h1 id="question"  onclick="readQuestionFunc();"></h1>
        <!-- Question heading -->
	      
	    <div id="questionImageArea" >
		    <img id="questionImage" src="/images/blank.png" alt="quiz image" loading="lazy">
	      </div>

	      
        <ul class="list-unstyled" id="optionContainers">
          <!-- Answer option containers -->
          <li><button id="option_1" class="btnMain  answer-option"></button></li>
          <li><button id="option_2"  class="btnMain   answer-option"></button></li>
          <li><button id="option_3"  class="btnMain   answer-option"></button></li>
          <li><button id="option_4"  class="btnMain  answer-option"></button></li>
        </ul>

	      
	


	
	
        <!-- Explanation area -->
        <div class="btn_container">
          <!-- Button container -->
          <div id="show-explanation-btn" class="btnMainBottom  d-none mt-3"  onclick="showExplanationFunc()">Show Explanation</div>
          <div id="skip-next-btn" class="btnMainBottom   mt-3"  onclick="skipOrNext()">Skip</div>
        </div>
      </div>
    </div>
  </div>

		
	
		




		
  <div class="container mt-4 d-none" id="end-container">
    <!-- End Container -->
    <h2 id="result-text"></h2>
    <!-- Result Text -->
    <h2 class="mt-4">Your Final Score</h2>
    <!-- Final Score Heading -->
    <p id="score"></p>
    <!-- Score Placeholder -->
    <p id="feedback"></p>
    <!-- Feedback Placeholder -->
    <p><span id="earnedPoints"></span></p>
    <p>
      <div class="d-none" id="badgebox">
        <span>Awards</span>
        <div id="badgeView"></div>
      </div>
    </p>
      <!-- Feedback Section -->
    <label id="quizRating" for="rating">Quiz Rating:</label>
    <div id="ratingStars" class="rating">
  <span class="star" onclick="rateQuiz(1)">&#9734;</span>
  <span class="star" onclick="rateQuiz(2)">&#9734;</span>
  <span class="star" onclick="rateQuiz(3)">&#9734;</span>
  <span class="star" onclick="rateQuiz(4)">&#9734;</span>
  <span class="star" onclick="rateQuiz(5)">&#9734;</span>
</div>

<!-- Button to challenge a user -->
<button id="challengeButton" class="btnMain mt-4 other-quiz-btn" onclick="showSharePopover()">Challenge a Friend</button>

	  
	  <div id="endBtns" class="" >
<button id="leaveReviewBtn" class="other-quiz-btn  btn-secondary mt-4">Leave Feedback</button>
	  
    <button id="retake-btn" class="other-quiz-btn  btnMain mt-4 "  onclick="retakeQuizFunc()">Retake Quiz</button>
    <!-- Retake Quiz Button -->
    <button class="other-quiz-btn  btn-secondary mt-4" onclick="window.location.href = '/quizzes'">Try Another Quiz</button>
		  
		  <br><hr>
    <!-- Try Another Quiz Button -->
	  </div>
<div>
    <button id="endReviewBtn" class="other-quiz-btn  btnMain mt-4 "  onclick="openReviewFunc(false); openPopupsFunc('reviewPopup','reviewPopupBox');">Review Quiz</button>
<button id="viewStatsBtn" class="other-quiz-btn  btnMain mt-4 "  onclick="viewStatsFunc();">View Stats</button>
</div>
	  <br>

	  
    <div id="social-sharing" class="mt-4">
      <!-- Social Sharing Section -->
      <p>
        <a id="social_fb" href="" target="_blank" class="btn btn-social btn-facebook btn-primary"><i class="fab fa-facebook-f"></i> Share on Facebook</a>
        <!-- Share on Facebook Button -->
        <a id="social_tw" href="" target="_blank" class="btn btn-social btn-twitter btn-info"><i class="fab fa-twitter"></i> Share on Twitter</a>
        <!-- Share on Twitter Button -->
      </p>
      <p>
        <a id="social_red" href="" target="_blank" class="btn btn-social btn-reddit btn-danger"><i class="fab fa-reddit"></i> Share on Reddit</a>
        <!-- Share on Reddit Button -->
        <a id="social_ln" href="" target="_blank" class="btn btn-social btn-linkedin btn-primary" style="margin-right: 10px;"><i class="fab fa-linkedin"></i> Share on LinkedIn</a>
        <!-- Share on LinkedIn Button -->
      </p>
    </div>
				
	
		
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="Quizzatopia" data-color="#5F7FFF" data-emoji="" data-font="Cookie" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#ffffff" data-coffee-color="#FFDD00"></script>
  </div>
</main_section>

	 
	</main_section>


<!-- Popover content for sharing -->
<div id="popoverContent" class="popup">
  <div class="optionspopup">
  <div class="topTitles" >Start Challenge</div>
	  <div id="chell_list" >
	  <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="linkTab" href="#linkSection" role="tab" aria-controls="linkSection" aria-selected="true" onclick="shareSwitchTab('linkTab')">Share with a Link</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="friendsTab" href="#friendsSection" role="tab" aria-controls="friendsSection" aria-selected="false" onclick="shareSwitchTab('friendsTab')">Share with Friends</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="facebookTab" href="#facebookSection" role="tab" aria-controls="facebookSection" aria-selected="false" onclick="shareSwitchTab('facebookTab')">Share on Facebook</a>
      </li>
    </ul>

    <div class="tab-content">
      <!-- Share with a Link section -->
      <div class="tab-pane fade show active" id="linkTabSection" role="tabpanel" aria-labelledby="linkTab">
        <input type="text" id="shareLink" class="share-link-input" value="https://example.com/share" readonly />
        <button id="copyLinkButton" class="btn btn-primary" onclick="copyLink()">Copy Link</button>
      </div>

      <!-- Share with Friends section -->
      <div class="tab-pane fade" id="friendsTabSection" role="tabpanel" aria-labelledby="friendsTab">
        <ul id="friendsList">
          <!-- Dynamically generated list of friends -->
          <!-- Add your list of friends here or populate it dynamically using JavaScript -->

        </ul>
      </div>

      <!-- Share on Facebook section -->
      <div class="tab-pane fade" id="facebookTabSection" role="tabpanel" aria-labelledby="facebookTab">
        <button id="facebookShareButton" class="btn btn-primary">Share on Facebook</button>
        <!-- Add the Facebook share functionality here -->
        <!-- You can implement the Facebook share functionality using their SDK or other methods -->
      </div>
    </div>
    <button id="closeButtonChell" onclick="closeChellPopup()" class="close BottomCloseOptionsButton">Close</button>
  </div>
  </div>
</div>


	

<div id="reviewModal" class="modal">
  <div class="modal-content">
    <span id="closeModal" class="close">&times;</span>
	  <p>
<button class="  btnMain py-2 px-4" onclick="quickFeedback('Great Experience')">Great Experience</button>
<button class="  btnMain py-2 px-4" onclick="quickFeedback('User-Friendly Interface')">User-Friendly Interface</button>
<button class="  btnMain py-2 px-4" onclick="quickFeedback('Buggy')">Buggy</button>
<button class=" btnMain py-2 px-4" onclick="quickFeedback('Informative Content')">Informative Content</button>

		  
	  </p>
    <h2>Leave a Review</h2>
    <textarea id="reviewTextArea" placeholder="Enter your review or feedback"></textarea>
    <button id="submitReviewBtn" class=" btnMain" >Submit</button>
  </div>
</div>




<!-- Explanation Container -->
<div class="explanation-container PopupWrap">
  <div id="explanation-con" class="explanation">
    <div id="explanation_bar">
      <div id="difficulty"></div>
      <div id="realQustionNum"></div>
      <div></div>
      <div id="reportFormBTN" class="btnMain" onclick="closeExplanationPopup(); openReport();">Report</div>
    </div>
    <div class="center"><h3>Explanation</h3></div>
    <hr>
    <div id="explanation" onclick="readExplanationFunc()"></div>
    <button id="close-btn" class="BottomCloseOptionsButton">Close</button>
  </div>
</div>

<!-- Popup Message Container -->
<div id="popupMSG" class="popupMSG">
  <span id="popupMessage"></span>
</div>

<!-- Report Form Popup -->
<div id="reportForm" class="PopupWrap">
  <div id="reportContainer" class="optionspopup">
    <div class="form-group" id="reportView">
      <span onclick="closeReport()" class="close">&times;</span>
      <h3>What is the problem?</h3>
      <div class="quickReport">
        <!-- Quick report buttons -->
<button class="btnMain py-2 px-4" onclick="quickReport('Buggy')">Buggy</button>
<button class="btnMain py-2 px-4" onclick="quickReport('Missing Answer')">Missing Answer</button>
<button class="btnMain py-2 px-4" onclick="quickReport('Wrong Answer')">Wrong Answer</button>
<button class="btnMain py-2 px-4" onclick="quickReport('Word Misspelled')">Word Misspelled</button>
<button class="btnMain py-2 px-4" onclick="quickReport('Options Missing')">Options Missing</button>
      </div>
      <div class="form-group">
        <label for="reportDetails">Details</label>
        <textarea class="form-control" id="reportDetails" rows="4" required></textarea>
      </div>
      <hr>
      <button id="reportFormBTN" class="btn-main btn-block" onclick="submitReport('submit', 'reportForm');">Submit Report</button>
    </div>
  </div>
</div>
	
		

	  
	
	
<!-- Other Quizzes Container -->
<div id="otherQuizzes" class="container">
  <!-- Other Quizzes Content Goes Here -->
</div>

<!-- Review Popup -->
<div id="reviewPopup" class="popup">
  <div id="reviewPopupBox" class="popup-content">
    <h2 id="quizReviewName"></h2>
    <div id="reviewTop">
      <p><strong>Total Questions:</strong> <span id="totalQuestions"></span></p>
      <p><strong>Percent Done:</strong> <span id="percentDone"></span>%</p>
      <p><strong>Current Score:</strong> <span id="currentScore"></span>%</p>
    </div>
    <div class="tab">
      <button id="sortByAdded" class="sort-button">Last Added</button>
      <button id="sortByResponseTime" class="sort-button">Response Time</button>
    </div>
    <hr>
    <div class="scroll">
      <div id="correctTab" class="tab-content">
        <h3>Correct Answers</h3>
        <div id="correctList"></div>
      </div>
      <br>
      <div id="incorrectTab" class="tab-content">
        <h3>Incorrect Answers</h3>
        <div id="incorrectList"></div>
      </div>
    </div>
    <button id="closeReviewButton" class="BottomCloseOptionsButton" onclick="closeReviewPopup()">Close</button>
  </div>
</div>

<!-- Question Popup -->
<div id="questionPopup" class="popup">
  <div class="popup-content">
    <h3>Question</h3>
    <div id="content-wrap">
      <div id="questionTextArea" class="text-area"></div>
      <h3>Answer</h3>
      <div id="answerTextArea" class="text-area"></div>
      <h3>Explanation</h3>
      <div id="explanationTextArea" class="text-area"></div>
      <h3>Response</h3>
      <div id="responseTimeTextArea" class="text-area"></div>
    </div>
    <span class="close BottomCloseOptionsButton" onclick="closeQuestionPopup()">Close</span>
  </div>
</div>

<!-- Stats Popup -->
<div id="statsPopup" class="PopupWrap">
  <div id="statsPopupBox" class="optionspopup">
    <div class="scrollWrap">
      <div id="quizInfoPopup">
        <h3>Quiz Stats</h3>
        <div class="center block">
          <p>Quiz Code: <span id="quizCodePopup"></span></p>
          <p>Quiz Name: <span id="quizName"></span></p>
        </div>
        <hr>
        <div class="block">
          <p>Number of Questions: <span id="totalQuestions"></span></p>
          <p>Questons Completed: <span id="questionsCompleted"></span></p>
          <p>Percet Completed: <span id="percetCopleted"></span></p>
        </div>
        <div class="center block">
          <p>Score Percent: <span id="scorePercent"></span></p>
          <p>Score: <span id="bestScore"></span></p>
        </div>
        <div class="block">
          <p>Question Correct: <span id="questionCorrect"></span></p>
          <p>Question Incorrect: <span id="questionIncorrect"></span></p>
        </div>
        <div class="center block">
          <p>Time so far: <span id="timeSoFar"></span></p>
          <p>Quiz URL: <span id="quizURL"></span></p>
        </div>
      </div>
    </div>
    <button id="closeStatsButton" class="close BottomCloseOptionsButton" onclick="closeStatsPopup()">Close</button>
  </div>
</div>

<!-- Options Popup -->
<div id="optionsPopup" class="PopupWrap">
  <div id="optionsPopupBox" class="optionspopup">
    <div class="scrollWrap">
      <div id="quizInfoPopup">
        <div id="optionsMenu">
          <h3>Options</h3>
          <div class="block">
            <div class="form-check">
              <label for="audioButton">Audio:</label>
              <button id="audioButton">On</button>
            </div>
          </div>
          <div class="block">
            <div class="form-check">
              <label for="volumeSlider">Speech Volume:</label>
              <input type="range" id="volumeSlider" min="0" max="1" step="0.2">
            </div>
            <!-- More form-checks for audio options -->
          </div>
          <div class="block">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="animation-quiz">
              <label class="form-check-label" for="animation-quiz">
                Animate Quiz
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <button id="closeOptionsButton" class="close BottomCloseOptionsButton" onclick="closeOptions()">Close</button>
  </div>
</div>

<!-- Challenge Popup -->
<div id="challengePopup" class="PopupWrap d-none">
  <div id="" class="optionspopup">
    <div class="wrap">
      <div id="challengeInfo">
	      
<div class="loading_Main XL">Loading...</div>


	      
</div>

    </div>
    <span class="close BottomCloseOptionsButton" onclick="closeChallengePopup()">Close</span>
  </div>
</div>


	


	
  <script>
	function startChallegeFunc(){
		
  window.location.href =  `https://www.quizzatopia.com/challenge/?${quizCode}&start`;

	  }



	  
function loadQuestionsCompleted(quizCode) {
  const quizInfoStored = localStorage.getItem(`quizInfo_${quizCode}`);
  const quizInfo = quizInfoStored ? JSON.parse(quizInfoStored) : {};
  const questionsCompleted = quizInfo.questionsCompleted || [];
  return questionsCompleted;
}

	//console.log("questionsCompleted...."+quizInfo.questionsCompleted);

	  
// Open the question popup
function openQuestionPopup(questionIndex, Count) {
  const question = questionsOG[questionIndex];
  const questionTextArea = document.getElementById("questionTextArea");
  const answerTextArea = document.getElementById("answerTextArea");
  const explanationTextArea = document.getElementById("explanationTextArea");
  const responseTimeTextArea = document.getElementById("responseTimeTextArea");
  
  questionTextArea.innerHTML = question.question;
  answerTextArea.innerHTML = question.answer;
  explanationTextArea.innerHTML = question.explanation;
	
	questionsCompleted = loadQuestionsCompleted(quizCode);


//let questionIndex = 0; // Replace with the desired question index
let newResponseTime = questionsCompleted[Count].responseTime;

console.log("responseTime:", newResponseTime);


let minutes = Math.floor(newResponseTime / 60000); // Convert milliseconds to minutes
let seconds = Math.floor((newResponseTime % 60000) / 1000); // Convert remaining milliseconds to seconds

// Display the timeElapsed in minutes and seconds format
 responseTimeTextArea.innerHTML  = `${minutes} mins ${seconds} secs`;
				    
  
  const popup = document.getElementById("questionPopup");
  popup.style.display = "block";



	
}

function zoomOutTransition(elementId) {
  const element = document.getElementById(elementId);
  element.style.transition = "transform 0.3s ease";
  element.style.transform = "scale(0)";
  
  setTimeout(() => {
    element.style.display = "none";
  element.style.transition = "initial";
  element.style.transform = "initial";
	  
  }, 300);
}

// Usage example


function openPopupsFunc(xxx, zzz) {
			  slideIn(zzz);

  document.getElementById(xxx).style.display = "block";
  clearTimeout(timeoutId);

}


function viewStatsFunc(){
window.location.href = "https://www.quizzatopia.com/quiz/stats/?q=" + quizCode;

}
	  

// Close the question popup
function closeQuestionPopup() {

	
	zoomOutTransition("questionPopup");
//  document.getElementById("questionPopup").style.display = "none";

}

function closeStatsPopup(){
	zoomOutTransition("statsPopup");
//  document.getElementById("reviewPopup").style.display = "none";

}
	


function closeReviewPopup(){
	zoomOutTransition("reviewPopup");
//  document.getElementById("reviewPopup").style.display = "none";

}
	  


	  
function checkVarForValueFunc(questionIndex) {
  if (questionIndex < 0 || questionIndex === '' || questionIndex === null || questionIndex === undefined) {
    return false; // Indicates that the condition is true
  } else {
    return true; // Indicates that the condition is false
  }
}

	  var responseTimeTotal = 0;
// Open the review popup
function openReviewFunc(save) {
  var resultCount = 0;

  // Retrieve quiz information from local storage
  const quizInfoStored = localStorage.getItem(`quizInfo_${quizCode}`);
  const quizInfo = quizInfoStored ? JSON.parse(quizInfoStored) : {};

  // Get elements for tabs
  var correctTab = document.getElementById("correctTab");
  var incorrectTab = document.getElementById("incorrectTab");

  // Set up tab content
  incorrectTab.innerHTML = "<h3>Incorrect Answers</h3><div id='incorrectList'></div>";
  correctTab.innerHTML = "<h3>Correct Answers</h3><div id='correctList'></div>";

  // Display quiz name
  document.getElementById("quizReviewName").innerHTML = quizInfo.quizName;

  // Load completed questions
  questionsCompleted = loadQuestionsCompleted(quizCode);

  let questionStatInfo = [];
var responseTimeA = [];
  questionsCompleted.forEach(function (question) {
    var questionIndex = question.questionNumber - 1; // Adjust index by subtracting 1

    // Check if question index is valid
    let questionIndexBool = checkVarForValueFunc(questionIndex);
    if (questionIndexBool) {
      var questionDiv = document.createElement("div");
      questionDiv.classList.add("quiz-result-item");

      let questionNumber = questionIndex + 1;
      let questionResponseTime = questionsCompleted[resultCount].responseTime;

      if (question.correctness === "correct") {
        questionDiv.classList.add("correct");
        let correctness = "correct";
        questionStatInfo.push({ questionNumber: questionNumber, responseTime: questionResponseTime, correctness: correctness });
      } else if (question.correctness === "incorrect") {
        questionDiv.classList.add("incorrect");
        let correctness = "incorrect";
        questionStatInfo.push({ questionNumber: questionNumber, responseTime: questionResponseTime, correctness: correctness });
      }

      // Add click event to open question popup
      (function (resultCount) {
        questionDiv.addEventListener("click", function () {
          openQuestionPopup(questionIndex, resultCount);
        });
      })(resultCount);

      // Process response time
      responseTimeA.push(questionsCompleted[resultCount].responseTime);

      let minutes = Math.floor(questionResponseTime / 60000);
      let seconds = Math.floor((questionResponseTime % 60000) / 1000);
      let responseTimeText = `${minutes} mins ${seconds} secs`;

      // Create and append elements for review
      let reviewQuestionNumber = document.createElement("span");
      reviewQuestionNumber.classList.add("question-number");
      reviewQuestionNumber.innerHTML = "<b>Question:</b> " + (questionIndex + 1) + "  <b>Response Time:</b> " + responseTimeText;

      let reviewQuestionText = document.createElement("span");
      reviewQuestionText.classList.add("question-text");
      if (QuizFromDB === true) {
        reviewQuestionText.textContent = questionsOG[resultCount].question;
      } else {
        reviewQuestionText.textContent = questionsOG[questionIndex].question;
      }

      questionDiv.appendChild(reviewQuestionNumber);
      questionDiv.appendChild(reviewQuestionText);

      // Insert question div into correct or incorrect list
      if (question.correctness === "correct") {
        const parentElement = document.getElementById("correctList");
        const firstChild = parentElement.firstChild;
        parentElement.insertBefore(questionDiv, firstChild);
      } else if (question.correctness === "incorrect") {
        const parentElement = document.getElementById("incorrectList");
        const firstChild = parentElement.firstChild;
        parentElement.insertBefore(questionDiv, firstChild);
      }
      resultCount++; // Increment resultCount here
    } else {
      incorrectTab.innerHTML = "<h3>No Results</h3>";
      correctTab.innerHTML = "";
    }
  });



  // Count incorrect and correct answers
  let incorrect = questionStatInfo.filter(question => question.correctness === 'incorrect').length;
  let correct = questionStatInfo.filter(question => question.correctness === 'correct').length;
	
  if (save === true && quizStarted === false) {
    // Calculate total response time and save review data
    responseTimeTotal = getArraySum(responseTimeA);
    saveReviewDataToFirestore(quizCode, quizInfo.quizName, questionStatInfo, responseTimeTotal, correct);
  }
  // Calculate and display statistics
  const totalQuestions = questionsCompleted.length;
  const percentDone = (questionsCompleted.length / questions.length) * 100;
  const currentScore = (correct / questions.length) * 100;

  // Update the HTML display with the calculated values
  document.getElementById('totalQuestions').textContent = totalQuestions;
  document.getElementById('percentDone').textContent = Math.round(percentDone);
  document.getElementById('currentScore').textContent = Math.round(currentScore);

  // Display review popup if save is false
  if (save === false) {
    slideIn("reviewPopupBox");
    document.getElementById("reviewPopup").style.display = "block";
  }
}

	  
function getArraySum(arr) {
  let sum = 0;
  for (let i = 0; i < arr.length; i++) {
    if (typeof arr[i] === 'number') {
      sum += arr[i];
    }
  }
  return sum;
}

async function updateChallengeWithReview(uID, challengeNumber, startTime, docRef, correct) {
    try {
        const db = firebase.firestore();

        const challengeQuerySnapshot = await db.collection('challenges')
            .where('challengeNumber', '==', challengeNumber)
            .get();

        if (challengeQuerySnapshot.empty) {
            console.log('Challenge not found.');
            return;
        }
 console.log(' docRef.id    '+docRef);

        const challengeDoc = challengeQuerySnapshot.docs[0];
        const challengeData = challengeDoc.data();
        const { challengerID, requesterID } = challengeData;

        if (uID === challengerID || uID === requesterID) {
            const updateData = {
                startTime: startTime,
            };

            if (uID === challengerID) {
                updateData.challengerReview = docRef;
                updateData.challengerCorrect = correct;
                updateData.challengerDone = 'Done';
                updateData.challengerEndTime = new Date();
            } else {
                updateData.requesterReview = docRef;
                updateData.requesterCorrect = correct;
                updateData.requesterDone = 'Done';
                updateData.requesterEndTime = new Date();
            }

            // Use set with merge: true to add fields if they don't exist
            await challengeDoc.ref.set(updateData, { merge: true });

            localStorage.removeItem('challengeNumber');
            localStorage.removeItem('startTime');

            console.log(`Challenge ${challengeNumber} updated successfully.`);
        } else {
            console.log('User is not the challenger or requester of this challenge.');
        }
    } catch (error) {
        console.error('Error updating challenge:', error);
    }
}



	  
async function saveReviewDataToFirestore(quizCode, quizName, questionStatInfo, responseTimeTotal, correct) {
	  const userInfo = getUserInfo();
  // Get reference to Firestore database
  const db = firebase.firestore();
getQuizLink();

  // Reference to the 'quizReviewData' collection
  const quizReviewDataRef = db.collection('quizReviewData');

  // Create a new document in the 'quizReviewData' collection
  quizReviewDataRef.add({
    userID:  userInfo.firebaseId,
    timeStamp: new Date(),
    quizCode: quizCode,
    quizURL: quizLink,
      quizName: quizName,
	  questionStatInfo: questionStatInfo,
    responseTimeTotal: responseTimeTotal,
  })
    .then(docRef => {
      console.log("Review data saved successfully. Document ID:", docRef.id);

const challengeNumber = localStorage.getItem('challengeNumber');
const startTime = parseInt(localStorage.getItem('startTime'));
 console.log(' challengeNumber    '+challengeNumber);
 console.log(' startTime    '+startTime);
 console.log(' docRef.id    '+docRef.id);
 console.log(' correct    '+correct);

	  
 updateChallengeWithReview(uID, challengeNumber, startTime, docRef.id, correct);

	    
    })
    .catch(error => {
      console.error("Error saving review data:", error);
    });
}





	  




	

	   var volumeSlider = document.getElementById('volumeSlider');
 var voiceDropdown = document.getElementById('voiceDropdown');
 var rateSlider = document.getElementById('rateSlider');
var animationCheckbox = document.getElementById('animation-quiz');
var quizCodeElement = document.getElementById('quizCodePopup');
	  
const questionsCompletedElement = document.getElementById('questionsCompleted');
const totalQuestionsElement = document.getElementById('totalQuestions');
const questionCorrectElement = document.getElementById('questionCorrect');
const questionIncorrectElement = document.getElementById('questionIncorrect');
const timeSoFarElement = document.getElementById('timeSoFar');
const scorePercentegeElement = document.getElementById('scorePercent');
const percetCopletedElement = document.getElementById('percetCopleted');
const quizURLElement = document.getElementById('quizURL');
const quizNameElement = document.getElementById('quizName');


	  window.addEventListener("load", function() {


		  
// Event listeners and functions for the options menu


volumeSlider.addEventListener('input', updateVolume);

		  if(voiceDropdown){
voiceDropdown.addEventListener('change', updateVoice);
		  }
if(rateSlider){		  
rateSlider.addEventListener('input', updateRate);
}
if(animationCheckbox){		  
animationCheckbox.addEventListener('change', toggleAnimation);
}
	  });

// Function to update the volume
function updateVolume() {
	if(volumeSlider){
  const volume = parseFloat(volumeSlider.value);
  // Update the volume value
  // Your logic for handling the volume change goes here
  utterance.volume = volume;

  // Output the current volume to the console
  console.log('Current volume:', utterance.volume);

  // Save the volume value to local storage
saveSettings('volume', volume);
	}
}

// Function to update the voice
function updateVoice() {
  const selectedVoice = voiceDropdown.value;
  // Update the voice selection
  // Your logic for handling the voice change goes here
	getMatchingVoice(selectedVoice);
}

// Function to update the speech rate
function updateRate() {
  // Update the speech rate value
  // Your logic for handling the rate change goes here
  voiceSettings = {
    rate: parseFloat(rateSlider.value),
    voice: voiceDropdown.value
  };
  
saveSettings('voiceSettings', voiceSettings);
}

// Function to toggle the animation
function toggleAnimation() {
  const isAnimated = animationCheckbox.checked;
  // Toggle the animation state
  // Your logic for handling the animation toggle goes here

  userInfo.animationEnabled = isAnimated;
isAnimationEnabled = userInfo.animationEnabled;
  localStorage.setItem('userInfo', JSON.stringify(userInfo));
	saveSettings('animationEnabled', isAnimated);

}


	  
const optionsPopup = document.getElementById('optionsPopup');

function openOptionsFunc() {
	console.log("openOptions ....");
	  clearTimeout(timeoutId);


  document.getElementById("optionsPopup").style.display = "block";

		  slideIn("optionsPopupBox");
}




function closeOptions(){
	zoomOutTransition("optionsPopup");

		  slideOut("optionsPopupBox");
}


function openStatsFunc() {
	console.log("Load and Save ....");

  clearTimeout(timeoutId);

const userInfoStored = localStorage.getItem(`userInfo`);
  const userInfo = storedUserInfo ? JSON.parse(userInfoStored) : {};
	animationCheckbox.checked = userInfo.animationEnabled;

 console.log("userInfo .... "+userInfo.firebaseId);
const quizInfoStored = localStorage.getItem(`quizInfo_${quizCode}`);
 quizInfo = quizInfoStored ? JSON.parse(quizInfoStored) : {};

// Update the quiz information
quizCodeElement.innerHTML = quizInfo.quizCode || "";
timeSoFarElement.innerHTML = quizInfo.quizTime || "";
quizURLElement.innerHTML = quizInfo.quizLink || "";
quizNameElement.innerHTML = quizInfo.quizName || "";



questionsCompletedElement.innerHTML = quizInfo.questionsCompleted.length || 0;


	
let qCorrect = quizInfo.questionCorrect || 0;
let qIncorrect = quizInfo.questionIncorrect || 0;

let qCompleted = quizInfo.questionsCompleted.length || 0;


let totalQuestions = quizInfo.numberOfQuestions || 0;

questionCorrectElement.innerHTML = qCorrect || 0;
questionIncorrectElement.innerHTML = qIncorrect || 0;
totalQuestionsElement.innerHTML = totalQuestions || 0;

let percentCompleted = (qCompleted / totalQuestions) * 100;
let scorePercentage = (qCorrect / (qCorrect + qIncorrect)) * 100;

percetCopletedElement.innerHTML = percentCompleted ? percentCompleted.toFixed(1) + "%" : "0%";
scorePercentegeElement.innerHTML = scorePercentage ? scorePercentage.toFixed(1) + "%" : "0%";


let currentTime = new Date();
let savedTime = new Date(quizInfo.startTime);

let timeElapsed = currentTime - savedTime;
let minutes = Math.floor(timeElapsed / 60000); // Convert milliseconds to minutes
let seconds = Math.floor((timeElapsed % 60000) / 1000); // Convert remaining milliseconds to seconds

// Display the timeElapsed in minutes and seconds format
timeSoFarElement.innerHTML = `${minutes} mins ${seconds} secs`;



		  slideIn("statsPopupBox");
  document.getElementById("statsPopup").style.display = "block";

}
var quizMainCategory = '';
// Function to fetch recommended quizzes from the database
// Function to fetch recommended quizzes from the database
function fetchRecommendedQuizzesFromDB(quizTagsArray, quizCategory) {
//  console.log("Fetching recommended quizzes from the database...");

  // Initialize your Firebase app
  const db = firebase.firestore();

  console.log("Quiz tags:", quizTagsArray);
  console.log("Quiz category:", quizCategory);
	
quizMainCategory = quizCategory;
	
  db.collection('quizzes')
    .get()
    .then((querySnapshot) => {
      const documents = querySnapshot.docs;
      const recommendedDocuments = [];
      const limit = 10;

      // Iterate through the documents
      documents.forEach((doc) => {
        const quizData = doc.data();

        // Check if quizCategory matches
        if (quizData.quizTags) { // Check if quizTags is defined
          // Check if any quizTag matches
          const matchingTags = quizData.quizTags.filter(tag => quizTagsArray.includes(tag));
          if (matchingTags.length > 0) {
            recommendedDocuments.push(doc);
          }else   if (quizData.quizCategory === quizCategory) {
          recommendedDocuments.push(doc);
        } 
        }

        // Stop when reaching the limit
        if (recommendedDocuments.length >= limit) {
          return;
        }
      });

      // Randomly select documents
      while (recommendedDocuments.length < limit && documents.length > 0) {
        const randomIndex = Math.floor(Math.random() * documents.length);
        const randomDocument = documents.splice(randomIndex, 1)[0];
        recommendedDocuments.push(randomDocument);
      }

   // Get the reference to the HTML container
      const recommendedQuizContainer = document.getElementById('otherQuizzes');

      // Initialize the HTML string
      let html = '<h3>Recommended Quizzes</h3><hr><div class="recommendedQuizzes-column"><ul>';

      // Iterate over each recommended quiz document
      recommendedDocuments.forEach((doc) => {
        const quizData = doc.data();

        // Generate the HTML for each recommended quiz
        const quizHtml = `
          <li>
            <a href="${quizData.quizLinkDB}">
              ${quizData.quizNameDB}
            </a>
          </li>
        `;

        // Append the recommended quiz HTML to the overall HTML string
        html += quizHtml;
      });

      // Close the unordered list and the column div
      html += '</ul></div>';

      // Update the recommendedQuizContainer with the generated HTML
      recommendedQuizContainer.innerHTML = html;

     // console.log("Recommended quizzes fetched and HTML updated successfully.");
    })
    .catch((error) => {
      console.error("Error fetching recommended quizzes:", error);
    });
}







	  
const element = document.getElementById("discussionContainer");
element.addEventListener("click", function() {
  window.open("https://www.facebook.com/Quizzatopia/", "_blank");
  //window.open("https://www.quizzatopia.com/community/", "_blank");
});

	  
window.addEventListener("load", function() {


	// Check if user is logged in
  if (loggedIn   ==  false) {
		const timerId = setTimeout(() => {
		 // Show the login popup
openPopup();	
}, 5000); // Timer will execute after 5000 milliseconds (5 seconds)
	  
  }
			  	    //  console.log("loggedIn 2.... "+loggedIn);
// Call the function to fetch and populate the quiz data
});
	</script>
	
	
	
	
  <script>
    
	
	  
    function  showPieChartFront(Correctpie,Incorrectpie){
 let Correct1 = parseInt(Correctpie);
 let Incorrect1 = parseInt(Incorrectpie);

   const chartCanvas1 = document.createElement('canvas');
chartCanvas1.id = 'pie-chart_1';
   
 
   
   // Create the data for the pie chart
 let pieData1 = {
  labels: ['Correct', 'Incorrect'],
  datasets: [{
    data: [Correct1, Incorrect1],
    backgroundColor: ['#36a2eb', '#ff6384']
  }]
};
   // Append the canvas to the chart container
const chartContainer1 = document.getElementById('pie_graph_front');
chartContainer1.appendChild(chartCanvas1);
	    
   /// console.log(Correct1+" showPieChartFront info     "+ Incorrect1); 
  
  // Get the 2D context of the canvas
const ctx = chartCanvas1.getContext('2d');



// Configure the options for the pie chart
const options1 = {
  responsive: true
};

// Create the pie chart using Chart.js
new Chart(ctx, {
  type: 'pie',
  data: pieData1,
  options: options1
});
  
 
}
	  
	  
	  
	  
	  
function calculateScore(quizInfo) {
  const totalQuestions = quizInfo.numberOfQuestions || 0;
  const correctAnswers = quizInfo.questionCorrect || 0;

  const score = correctAnswers;
  const percentage = totalQuestions > 0 ? (correctAnswers / totalQuestions) * 100 : 0;

  return {
    score,
    percentage,
  };
}

	  
	function saveQuizInfo(quizCode, quizInfo, q) {
if(quizStarted == true){
  const savedQuizInfo = JSON.parse(localStorage.getItem(`quizInfo_${quizCode}`)) || {};
  const savedScore = savedQuizInfo.questionCorrect || 0;
  const newScore = quizInfo.questionCorrect || 0;

 
 if (newScore > savedScore ){
	  	  updatePoints(pointsRewards);
 }

	

	 //  console.log('  saveQuizInfo Quiz Info Local:' + quizInfo);
	
    // Update the quiz information for the specific quiz code
  localStorage.setItem(`quizInfo_${quizCode}`, JSON.stringify(quizInfo));

}
}


  // Call the saveQuizInfo function with the "q" parameter
//saveQuizInfo(quizCode, quizInfo, q);

	  
	  
	  
	  
	  
// Log the contents of the storage
function logStorageContents(quizCode) {
  const savedQuizInfo = localStorage.getItem(`quizInfo_${quizCode}`);
//  console.log('logStorageContents Quiz Code:', quizCode);
  //console.log('logStorageContents Quiz Info:', savedQuizInfo);
}


	  
	  
		  
	  function formatTime(milliseconds) {
  const date = new Date(milliseconds);

  const hours = String(date.getHours()).padStart(2, '0');
  const minutes = String(date.getMinutes()).padStart(2, '0');
  const seconds = String(date.getSeconds()).padStart(2, '0');

  return `${hours}:${minutes}:${seconds}`;
}

// Get the current time in milliseconds
var currentTime = Date.now();

// Format the current time
var formattedTime = formatTime(currentTime);
	  
	  var currentTimeInMillis = formattedTime;
// console.log(' currentTimeInMillis    '+currentTimeInMillis);

	  
var quizLinkURL = '';

var  quizType = '';	  
    




// Get the current URL and parse its search parameters
var urlParams = new URLSearchParams(window.location.search);
	//  console.log("1 urlParams     "+urlParams); 



	  


// Example usage
	  
// Get the values of the "q" and "e" parameters
var q = urlParams.get('q');
var e = urlParams.get('e');
	  




	  function getRandomFile() {
		  const randomNumber = Math.floor(Math.random() * 301); 

    return   q = "q_"+randomNumber+"_";

  }



if (q === null) {

   q = getRandomFile();
}
  
	  
	

 
	  








var challengeNumber = '';


function getChallengeFunc(){

// Get the query parameters from the URL
const queryParams = new URLSearchParams(window.location.search);
let userID = queryParams.get("userID");
 challengeNumber = queryParams.get("challengeNumber");

	if(challengeNumber){

      document.getElementById("challengePopup").classList.remove("d-none");

	
// Reference to Firestore collection
const db = firebase.firestore();
const challengesCollection = db.collection("challenges");
		
		
// Query the challenges collection for the challenge with the specified challengeNumber
challengesCollection
  .where("challengeNumber", "==", challengeNumber)
  .get()
  .then((querySnapshot) => {
    if (!querySnapshot.empty) {
      // Get the challenge document
      const challengeDoc = querySnapshot.docs[0];
      const challengeData = challengeDoc.data();

      // Hide the MessageBoard info
   //   document.getElementById("otherQuizzes").classList.add("d-none");
	    
	    
	    let cellUserName = '';
                   let requesterUname = challengeData.requesterUname;
	let challengerName = challengeData.challengerName;

	  
		    
let quizLink = challengeData.quizLink;
console.log("E quizLink: " + quizLink);

 urlParams = new URLSearchParams(quizLink);
 q = urlParams.get('q');
 e = urlParams.get('e');

//console.log("Parameter q: " + q);
//console.log("Parameter e: " + e);

  fetchData(q, e);

	if(challengeData.requesterID === userID){
  cellUserName = challengerName;
	}else{
  cellUserName = requesterUname;
	}


	



	    
      // Display the challenge data on the page
      // For example, update HTML elements with the challenge information
const challengeInfoElement = document.getElementById("challengeInfo");
challengeInfoElement.innerHTML = `
  <div class="challenge-details">
    <h2 class="challenge-title">${challengeData.quizName}</h2>
    <div class="challenge-meta">
      <p><span class="meta-label">Question Count:</span> ${challengeData.questionCount}</p>
      <p><span class="meta-label">Challenger:</span> ${challengeData.challengerName}</p>
      <p><span class="meta-label">Requester:</span> ${challengeData.requesterUname}</p>
      <p><span class="meta-label">Challenge Number:</span> ${challengeData.challengeNumber}</p>
    </div>
    <div class="box">
      <button id="startChallengeBtn" class="btn-main" onclick="startChallenge()">Start Challenge</button>
    </div>
    <hr class="divider">
    <div class="challenge-description">
      <p>
        You are about to take part in a challenge against ${challengeData.challengerName}.
        This challenge was requested by ${challengeData.requesterUname}. The quiz consists of
        ${challengeData.questionCount} questions. Are you ready to compete and prove your knowledge?
      </p>
    </div>
  </div>
`;

	      document.getElementById("otherQuizzes").classList.add("d-none");

    } else {
      console.log("No matching challenge found.");
    }
  })
  .catch((error) => {
    console.error("Error getting challenge:", error);
  });

	  }
	  }

getChallengeFunc();



	  
function closeChallengePopup(){

    window.location.href = `/challenge`;
  }


async function startChallenge() {
		        console.log("Passed ");

  loadScreenFunc();
	    const startTime = new Date().getTime();
		   //     console.log("Passed 0");

    // Add challenge number and start time to local storage
    localStorage.setItem('challengeNumber', challengeNumber);
    localStorage.setItem('startTime', startTime);
	
userExitNotificationBool = false;
	
  const divElement = document.getElementById("testInfo");


  if (loggedIn == false) {
    // Show the login popup
    openPopup();
    switchTab('login');
  } else {

    if (q === null || q === '') {
      location.reload();
    } else {
      questionTime = 0; // seconds
      currentQuestion = 0;

      quizStarted = false;
      timer = 0;
	//    questionsCompleted = [];
      countdownPerQuestion = false; // set to true if the countdown should happen for each question
      totalTime = 0; // seconds
      totalQuestions = questions.length;
      timerEnabled = false;

      quizStarted = true;
      updatePointsAndRank();
      const animations = ["right", ""];
      const randomIndex = Math.floor(Math.random() * animations.length);
      const selectedAnimation = animations[randomIndex];
	        console.log("Passed 2");

      document.getElementById("optionContainer").classList.add("d-none");
	    
	    slideOut("challengePopup", selectedAnimation);
      document.getElementById("challengePopup").classList.add("d-none");
	    
	    slideIn("quiz-container", selectedAnimation);
      document.getElementById("quiz-container").classList.remove("d-none");
      totalQuestions = questions.length;

      // Retrieve the quizInfo from the array quiz
      const quizInfo = setUpandSaveQuizInfo(quizCode, quizName, numberOfQuestions);

      quizCode = quizInfo.quizCode;
      quizName = quizInfo.quizName;
      numberOfQuestions = quizInfo.numberOfQuestions;



	      document.getElementById("otherQuizzes").classList.add("d-none");


 var numAd;

  if (totalQuestions <= 15) {
    numAds = 2;
      if (totalQuestions <= 5) {
            numAds = 1;
      }
  } else {
    numAds = totalQuestions / 5;
  }

  var intvalue = Math.round(numAds);

  quizAdPattern = generateQuizAdPattern(totalQuestions, intvalue);
  adQuestionNumbers = quizAdPattern;

//console.log(quizAdPattern+'  quizAdPattern.userName ????????????intvalue '+ intvalue);
	    
  // Array to store the question numbers where the ad should be shown
//  adQuestionNumbers = quizAdPattern; // Example: Show ad after questions 3, 7, and 11

  setQuizTime();
   updateQuestionNumber();

  updateProgressBar(currentQuestion);
    showQuestion();
  
	          await updateQuizStartedCount(quizCode);

    }
  }
}



quizLinkURL = 	"/quiz/?"+urlParams;
	  
// Find the <link rel="canonical"> element
var canonicalLink = document.querySelector('link[rel="canonical"]');

// Update the href attribute of the <link rel="canonical"> tag
canonicalLink.href = "https://www.quizzatopia.com"+quizLinkURL;











		    
	  let str = q;

document.getElementById("social_fb").href = "https://www.facebook.com/sharer/sharer.php?u=https://quizzatopia.com/quiz/?q="+q;
document.getElementById("social_tw").href = "https://twitter.com/intent/tweet?url=https://quizzatopia.com/quiz/?q="+q;
document.getElementById("social_ln").href = "ttps://www.linkedin.com/shareArticle?url=https://quizzatopia.com/quiz/?q="+q;
document.getElementById("social_red").href = "https://www.reddit.com/submit?url=https://quizzatopia.com/quiz/?q="+q;
    
	  
	    
	  
/*
	  function removeTF(q) {

// Use the value of "q"
//console.log("urlParams 875:    "+q); 

if (str.startsWith("TF")) {
 q = str.substr(2); // Remove the first three characters
	return q;
}
	  
	  
	  }
	*/  
	

	  
async function saveQuizToDB(quiz) {
  const { quizCodeX, quizNameX, imageURLX, quizJsonX, numberOfQuestionsX, quizLinkX, quizDifficultyX } = quiz;

  const db = firebase.firestore();

  // Check if quiz already exists in Firestore
  const querySnapshot = await db.collection('quizzes').where('quizCodeDB', '==', quizCodeX).get();

  if (!querySnapshot.empty) {
    showPopup(`Quiz with code ${quizCodeX} already saved.`);
  } else {
    // Set quizDifficulty to an empty string if it is undefined
    const difficulty2 = typeof quizDifficultyX !== 'undefined' ? quizDifficultyX : '';

    // Check if required fields have valid values
    if (
      typeof quizCodeX !== 'undefined' &&
      typeof quizNameX !== 'undefined' &&
      typeof imageURLX !== 'undefined' &&
      typeof numberOfQuestionsX !== 'undefined' &&
      typeof quizLinkX !== 'undefined'
    ) {
      // Save quiz information to Firestore with an automatically generated document ID
      await db.collection('quizzes').add({
        quizCodeDB: quizCodeX,
        quizNameDB: quizNameX,
        imageURLDB: imageURLX,
        quizJsonDB: quizJsonX,	      
        numberOfQuestionsDB: numberOfQuestionsX,
        quizLinkDB: quizLinkX,
        quizDifficultyDB: difficulty2,
	    quizStartedCount: 0 // Initialize the quizStartedCount to 0

      });
	      
      showPopup(`Quiz with code ${quizCodeX} saved successfully.`);
    } else {
      showPopup('Invalid quiz data. Please provide all required fields.');
    }
  }
}


function showPopup(message) {
  const popup = document.getElementById('popupMSG');
  const popupMessage = document.getElementById('popupMessage');
  popupMessage.textContent = message;
  popup.style.display = 'block';

  setTimeout(() => {
    popup.style.display = 'none';
  }, 3000); // Hide the popup after 3 seconds
}

	  
	  
	  
	  

	  
	  
	  
	  
	  
	  
	  
	  
	  
	  

	  let questionData  = [];
 
let questionsOG = [];
let questions = [];
let quizCode;
let quizName;
let numberOfQuestions;
let quizImageURL;
let quizDifficulty;
let questionNumber;
let questionType;

let difficulty;
let imageURL;
	  
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}
	  
	  
// console.log('2 ???????????????????????????Start ???????    '+currentTimeInMillis);

	  

// Retrieve the stored test information and display it
let quizUrl;
var QuizFromDB = false;





function checkQuizCodeAndGetInfo(quizCode, quizName, numberOfQuestions, quizImageURL, quizDifficulty) {
  // Check if quiz info exists in localStorage
  const storedQuizInfo = localStorage.getItem(`quizInfo_${quizCode}`);

  if (storedQuizInfo) {
    try {
      // If quiz info exists, parse and return it
      const quizInfo = JSON.parse(storedQuizInfo);
      return quizInfo;
    } catch (error) {
      console.error('Error parsing stored quiz info:', error);
      // Handle error, display appropriate message or fallback behavior
    }
  } else {
    // If quiz info doesn't exist, create and store a new quizInfo object
    const quizInfo = {
      quizCode,
      quizName,
      numberOfQuestions,
      quizImageURL,
      quizDifficulty,
      questionsCompleted: 0, // Initialize questionsCompleted to 0
      // Add any other properties you want to store for quizInfo
    };

    // Store the quizInfo object in localStorage
    localStorage.setItem(`quizInfo_${quizCode}`, JSON.stringify(quizInfo));

    // Return the newly created quizInfo object
    return quizInfo;
  }
}





	  
function fetchData(q, e) {
          questions = [];
          questionsOG = [];
	  questionData = [];
  // Initialize Firebase app
  //firebase.initializeApp(firebaseConfig);

  // Now you can use Firestore and other Firebase services
  const firestore = firebase.firestore();
  
  return new Promise((resolve, reject) => {
    let stringEnt;
    if (e) {
      if (e === "user") {
       // console.log(' load DB ???????????????????????????Start ???????    ' + currentTimeInMillis);
        console.log("DB JSON structure");
        if (QuizFromDB) {
          // If data is already fetched, resolve the promise and return early
          console.log('Data is already fetched from DB');
          resolve();
          return;
        }

        QuizFromDB = true;
const quizRef = firebase.firestore().collection("quizzes").where("quizCodeDB", "==", q).limit(1);
        quizRef.get().then(function(querySnapshot) {
          if (!querySnapshot.empty) {
            console.log('Found quiz with quizCodeDB equal to', q);
            querySnapshot.forEach(function(doc) {
              const quizDataDB = doc.data();
              const parsedQuizDataDB = JSON.parse(quizDataDB.quizDataDB);

              // Use the quizDataDB here
              // Update quizCode, quizName, numberOfQuestions
              quizCode = parsedQuizDataDB.quizCode;
              quizName = parsedQuizDataDB.quizName;
              numberOfQuestions = parsedQuizDataDB.numberOfQuestions || "";
              quizImageURL = parsedQuizDataDB.imageURL;
              quizDifficulty = parsedQuizDataDB.quizDifficulty || "";
              quizCategory = parsedQuizDataDB.quizCategory || "";
              quizTags = parsedQuizDataDB.quizTags || "";

              console.log('Fetched quiz data from DB:', parsedQuizDataDB);

              // Parse the quizDataDB.quizDataDB string to a JSON object
              // Use the parsedQuizDataDB.questions array to populate questionData
               questionData = parsedQuizDataDB.questions.map(questionObj => ({
                questionNumber: questionObj.questionNumber,
                question: questionObj.question,
                imageURL: questionObj.imageURL,
                questionType: questionObj.questionType,
                options: questionObj.options,
                answer: questionObj.answer,
                quizTags: questionObj.quizTags,
                quizCategory: questionObj.quizCategory,
		      explanation: questionObj.explanation,
                difficulty: questionObj.difficulty
              }));

		    
      displayTestInfo(quizCode, quizName, numberOfQuestions, quizImageURL, quizDifficulty);

              questions.push(...questionData);
              questionsOG.push(...questionData);

              shuffleArray(questions);

              // Access and use the retrieved quiz information
              const questionsCompleted = quizInfo.questionsCompleted;

              // Resolve the promise since data is fetched
              resolve();
            });
          } else {
            console.log("No quiz found with quizCodeDB equal to", q);
            // Resolve the promise even if there's no quiz found to avoid blocking
            resolve();
          }
        }).catch(function(error) {
          console.error("Error getting quiz document: ", error);
          // Reject the promise if there's an error
          reject(error);
        });
      } else {
        console.log("New JSON structure");
        stringEnt = "/q/" + e + "/" + q + ".json";
      }
    } else {
      console.log("Old JSON structure");
      stringEnt = "/q/New/" + q + ".json";
    }

    quizUrl = stringEnt;
    // Fetch data from URL
    if (e !== "user") {
      QuizFromDB = false;
      fetch(stringEnt)
        .then(response => response.json())
        .then(data => {
          // Determine the JSON structure directly from the data
          const isOldJSONStructure = data.length !== undefined;
          console.log(isOldJSONStructure ? "Old JSON structure" : "New JSON structure");

          if (isOldJSONStructure ? data.length === 0 : data.questions.length === 0) {
            // Handle empty data
            console.log("Empty data");
            const randomFile = getRandomFile(files);
            fetchData(randomFile);
            return;
          }

          // Use the questions data here
          const questionData = isOldJSONStructure
            ? data.map(questionObj => ({
                question: questionObj.question,
                answer: questionObj.answer,
                quizTags: questionObj.quizTags,
                quizCategory: questionObj.quizCategory,
		    options: questionObj.options,
                difficulty: questionObj.difficulty,
                imageURL: questionObj.imageURL,
                questionType: questionObj.questionType,
                questionNumber: questionObj.questionNumber,
                explanation: questionObj.explanation,
              }))
            : data.questions.map(questionObj => ({
                question: questionObj.question,
                answer: questionObj.answer,
                quizTags: questionObj.quizTags,
                quizCategory: questionObj.quizCategory,
		    options: questionObj.options,
                difficulty: questionObj.difficulty,
                imageURL: questionObj.imageURL,
                questionType: questionObj.questionType,
                questionNumber: questionObj.questionNumber,
                explanation: questionObj.explanation,
              }));

          // Update quizCode, quizName, numberOfQuestions
          quizDescription = isOldJSONStructure ? "" : data.quizDescription;
          quizCode = isOldJSONStructure ? "" : data.quizCode;
          quizCategory = isOldJSONStructure ? "" : data.quizCategory;
          quizTags = isOldJSONStructure ? "" : data.quizTags;
          quizName = isOldJSONStructure ? "" : data.quizName;
          numberOfQuestions = isOldJSONStructure ? data.length : data.numberOfQuestions || "";
          quizImageURL = isOldJSONStructure ? "" : data.quizImageURL;
          quizDifficulty = isOldJSONStructure ? "" : data.quizDifficulty || "";

	

var descriptionLink = document.querySelector('meta[name="description"]');
descriptionLink.setAttribute("content", data.quizDescription+" "+q);

		quizTagsVar = data.quizTags;
quizCategoryVar = data.quizCategory;
  		//console.log(" data.quizTags:",  data.quizTags);

	
          // Check quiz code and retrieve or save quiz info
          const quizInfo = checkQuizCodeAndGetInfo(quizCode, quizName, numberOfQuestions, quizImageURL, quizDifficulty);
      displayTestInfo(quizCode, quizName, numberOfQuestions, quizImageURL, quizDifficulty);

          questions.push(...questionData);
          questionsOG.push(...questionData);
          shuffleArray(questions);

          // Access and use the retrieved quiz information
          const questionsCompleted = quizInfo.questionsCompleted;

          //quizDifficulty = typeof quizDifficulty !== 'undefined' ? quizDifficulty : "";
          let q_link = "/quiz" + q;

          const quizZZ = {
            quizCodeX: quizCode,
            quizNameX: quizName,
            imageURLX: "https://www.quizzatopia.com/images/sq/_.png",
            numberOfQuestionsX: numberOfQuestions,
            quizJsonX: quizUrl,
            quizLinkX: quizLinkURL ? quizLinkURL : q_link, // Use 'q' if quizLinkURL is empty
            quizDifficultyX: quizDifficulty ? quizDifficulty : "",
          };

	  
          if (e === null || e === "") {} else {
            saveQuizToDB(quizZZ);
          }
       //   console.log("quizZZ:", quizZZ);

          // Resolve the promise since data is fetched
          resolve();
        })
        .catch(error => {
          console.error(error);
          // Reject the promise if there's an error
          reject(error);
        });
    } else {
      // Resolve the promise since data is fetched
      resolve();
    }
  });
}

// Rest of the code remains the same...
function viewStatsFunc() {
  try {
    // Ensure quizCode is defined and not empty
    if (quizCode) {
      const statsURL = "https://www.quizzatopia.com/quiz/stats/?q=" + quizCode;
      window.location.href = statsURL;
    } else {
      console.error("quizCode is not defined or empty.");
    }
  } catch (error) {
    console.error("Error navigating to stats page:", error);
  }
}


	  
function displayTestInfo(quizCodeNS, quizNameNS, numberOfQuestionsNS, quizImageURL_NS, quizDifficultyNS) {
  const storedQuizInfo = localStorage.getItem(`quizInfo_${quizCodeNS}`);
  const testInfoDiv = document.getElementById('testInfo');
  const optionsQuizNameDiv = document.getElementById('optionsQuizName');

	var attemptsMade;
const userInfo = getUserInfo();
countDocumentsWithQuizCodeAndUserID(quizCodeNS, userInfo.firebaseId)
  .then((attemptsMade) => {
	  attemptsMade = attemptsMade;
    console.log("attemptsMade:", attemptsMade);


const totalAttempts = 3;
	  if(attemptsMade >= totalAttempts){
document.getElementById('start-btn').style.display = "none";
	  }
// Get the attempts container element
const attemptsContainer = document.querySelector('.attempts-container');

// Update the stars based on the number of attempts made
for (let i = 0; i < totalAttempts; i++) {
  const star = document.createElement('span');
  star.textContent = i < attemptsMade ? '★' : '☆';
  star.classList.add(i < attemptsMade ? 'filled-star' : 'empty-star');
  attemptsContainer.querySelector('.stars').appendChild(star);
}

// Update the attempts text
attemptsContainer.querySelector('.attempts-text').innerHTML = `<strong>${attemptsMade}/${totalAttempts} Attempts</strong>`;


	  
  })
  .catch((error) => {
    console.error("Error:", error);
  });





  if (storedQuizInfo) {
    try {
      const quizInfo = JSON.parse(storedQuizInfo);

      // Calculate user score and completion percentage
      const { score, percentage } = calculateScore(quizInfo);
      let ansWrong = numberOfQuestionsNS - score;

      let descriptionArea = quizInfo.quizDescription ? `<p><strong>Quiz Description:</strong> ${quizInfo.quizDescription}</p>` : "";
      let categoryArea = quizInfo.quizCategory ? `<p><strong>Quiz Category:</strong> ${quizInfo.quizCategory}</p>` : "";


      if (score > 0) {
        // Show the pie chart for correct and incorrect answers
        showPieChartFront(score, ansWrong);
      }

      testInfoDiv.innerHTML = `
        <h3>Quiz Information</h3>
        <p><strong>Quiz Code:</strong> ${quizInfo.quizCode}</p>
        ${categoryArea}
        ${descriptionArea}
        <p><strong>Quiz Difficulty:</strong> ${quizDifficultyNS || 'N/A'}</p>
        <p><strong>Number of Questions:</strong> ${quizInfo.numberOfQuestions}</p>
        <p><strong>Question Correct:</strong> ${score}</p>
        <p><strong>Best Score:</strong> ${percentage.toFixed(0)}%</p>
	<div class="attempts-container"   onclick="viewStatsFunc('${quizInfo.quizCode}')" >
   <div class="attempts-text"></div>
  <div class="stars"></div>
</div>
      `;

      // Update the title tag
      document.title = quizNameNS;
      optionsQuizNameDiv.innerHTML = `<h1>${quizNameNS}<h1>`;




	  
      logStorageContents(quizInfo.quizCode);
    } catch (error) {
      console.error('Error parsing stored quiz info:', error);
      // Handle error, display appropriate message or fallback behavior
    }
  } else {
    // Handle case where there is no stored quiz info, display appropriate message or fallback behavior
    testInfoDiv.innerHTML = `
        <h3>Quiz Information</h3>
        <p><strong>Quiz Code:</strong> ${quizCodeNS}</p>
        <p><strong>Quiz Difficulty:</strong> ${quizDifficultyNS || 'N/A'}</p>
        <p><strong>Number of Questions:</strong> ${numberOfQuestionsNS}</p>
        <p><strong>No quiz information found.</strong></p>
      `;

    // Update the title tag
    document.title = quizNameNS;
    optionsQuizNameDiv.innerHTML = `<h1>${quizNameNS}<h1>`;

  }
	  removeOverlayWithoutTimer();

	      document.getElementById("start-btn").removeAttribute("disabled");
	 console.log("loaded removeOverlayWithoutTimer     "); 
}





	  
window.addEventListener("load", function() {
	if(challengeNumber !== ""){
  fetchData(q, e)
    .then(() => {

// Call the fetchRecommendedQuizzesFromDB function with quizTagsVar and quizCategoryVar
fetchRecommendedQuizzesFromDB(quizTagsVar, quizCategoryVar);
		
    })
    .catch(error => {
      // Handle any errors that occurred during fetchData
      console.error("Error fetching data:", error);
    });
	}
});

	  

	
if (  q === null || q === '') {
  console.log("empty.");

  location.reload();
}else{
console.log("Viewed:   "+q);
	
}


// Check if animation is enabled in local storage
const storedUserInfo = localStorage.getItem('userInfo');
  animationCheckbox = document.getElementById('animation-quiz');

if (storedUserInfo) {
  const userInfo = JSON.parse(storedUserInfo);
  // Access the animationEnabled property
  isAnimationEnabled = userInfo.animationEnabled;
  // Use the isAnimationEnabled value as needed
	animationCheckbox.checked = isAnimationEnabled;
} else {
  // Handle case when no user info is stored in the local storage
  isAnimationEnabled = false;
	animationCheckbox.checked = isAnimationEnabled;
}

animationCheckbox.addEventListener('change', function() {
  const storedUserInfo = localStorage.getItem('userInfo');
  const userInfo = storedUserInfo ? JSON.parse(storedUserInfo) : {};
  userInfo.animationEnabled = this.checked;
isAnimationEnabled = userInfo.animationEnabled;
  localStorage.setItem('userInfo', JSON.stringify(userInfo));
});
  





	  






// Function to generate the share link with the challenge ID
function setShareableLink(quizCode) {

	  
  return `https://www.quizzatopia.com/challenge/?${quizCode}&${uID}`;
}



// Function to open the popover and dynamically populate its content
function showSharePopover() {

	// console.log("showSharePopover      "); 

	  
  
  // Generate the share link with the challenge ID
  const shareLink = setShareableLink(quizCode);
  
  // Populate the input field with the share link
  $("#shareLink").val(shareLink);
  
  // Generate the friends list dynamically
  generateFriendsList();
  
    // Get the popover content element
  document.getElementById('popoverContent').style.display = 'block';
 	  slideIn("chell_list");


  
}

	    function shareFriendCodeFunc(uID){

const shareLink = `https://www.quizzatopia.com/friends/?${uID}`; // Replace with your actual link

// Check if the navigator.share() API is available
if (navigator.share) {
  const shareData = {
    title: 'Join Quizzatopia - Connect and Compete with Friends through Quizzes!',
    text: 'Explore, challenge, and connect with friends through quizzes on Quizzatopia. Join now for a fun trivia adventure!',
    url: shareLink,
  };

  // Call the navigator.share() method
  navigator.share(shareData)
    .then(() => console.log('Shared successfully'))
    .catch((error) => console.error('Error sharing:', error));
} else {
  // Fallback behavior for browsers that do not support navigator.share()
  console.log('navigator.share() API is not supported in this browser');
  // You can provide alternative sharing options here
  // For example, showing a social media sharing dialog
}
	    }


// Function to handle sharing on Facebook (you need to implement this based on Facebook API)
function shareOnFacebook() {
  // Add your code to share the quiz on Facebook using the Facebook API
  // For simplicity, we'll just show an alert here
  alert("Sharing on Facebook is not implemented yet.");
}



// Hide the popover when clicking outside
$(document).on("click", function (event) {
  if (!$(event.target).closest("#challengeButton, #popoverContent").length) {
    $("#popoverContent").hide();
  }
});

	  
 // Function to switch tabs
function shareSwitchTab(tabId) {
  const tabLinks = document.querySelectorAll('.nav-link');
  const tabPanes = document.querySelectorAll('.tab-pane');

  // Check if the tabId corresponds to a valid element
  const selectedTabLink = document.getElementById(tabId);
  const selectedTabPane = document.getElementById(tabId+"Section");
  if (!selectedTabLink || !selectedTabPane) {
//    console.error(`Element with id "${tabId}" not found.`);
//    console.log(`Selected tab link:`, selectedTabLink);
 //   console.log(`Selected tab pane:`, selectedTabPane);
    return; // Exit the function if the element is not found
  }

  tabLinks.forEach((link) => link.classList.remove('active')); // Remove active class from all tab links
  tabPanes.forEach((pane) => pane.classList.remove('show', 'active')); // Remove active class from all tab panes

  // Add active class to the selected tab link and tab pane
  selectedTabLink.classList.add('active');
  selectedTabPane.classList.add('show', 'active');
}





	  function closeChellPopup(){
  document.getElementById('popoverContent').style.display = 'none';
 	  slideOut("chell_list");

	  }

// Function to dynamically generate the friends list (replace this with your actual logic to fetch friends)
// Function to generate the list of friends
async function generateFriendsList() {
  try {
    const { friends, userData } = await getUserFriendsWithUserData(userInfo.firebaseId);

    // Clear previous list items
    $("#friendsList").empty();

    // Generate list items for each friend
      let friendsHTML = "";
    friends.forEach((friend) => {
      // Assuming userData contains properties 'userName', 'userProfilePic', and 'userPoints'
      const friendName = userData.userName;
      const friendPicture = userData.userProfilePic;
      const friendPoints = userData.userPoints;
      const friendfirebaseId = userData.firebaseId;

      // Create an image element with its source set to the friend's picture
      const imgElement = `<img src="${friendPicture}" alt="${friendName}" width="40" height="40">`;

      // Create a span element for the friend's points
      const name = `<span>${friendName}</span>`;
      const points = `<span>${friendPoints}</span>`;

      // Create the list item HTML with the friend's name, picture, and points
      const listItemHTML = `
        <li class='friends' onclick="handleFriendClick('${friendName}', '${friendfirebaseId}')">
        <div> <div> ${imgElement}</div>
         <div> ${name}</div></div>
         <div> ${points}</div>
         <div> ${friend}</div>
        </li>
      `;

      // Concatenate the HTML for each friend
      friendsHTML += listItemHTML;
    });

    // Set the innerHTML of friendsList with the generated HTML
    $("#friendsList").html(friendsHTML);
  } catch (error) {
    console.error('Error fetching friends and user data:', error);
  }
}


function handleFriendClick(friendName, friendfirebaseId) {
  // Add your logic to handle the click event here
  console.log("Friend clicked:", friendName);
  // For example, you can display more details about the friend or perform some action.
  removeFriend(friendfirebaseId);
}



	  
// Function to remove a friend
async function removeFriend(friendFirebaseId) {
  try {
    // Get a reference to the "friends" collection
    const friendsCollectionRef = firebase.firestore().collection("friends");
  const userInfo = getUserInfo();


  // Update the navigation ba
  const currentUserFirebaseId = userInfo.firebaseId;
	  
    // Find the friendship documents where either user1 or user2 matches the current user or friend id
    const friendshipQuery = await friendsCollectionRef
      .where("user1", "in", [currentUserFirebaseId, friendFirebaseId])
      .where("user2", "in", [currentUserFirebaseId, friendFirebaseId])
      .get();

    if (friendshipQuery.empty) {
      // Friendship does not exist, handle accordingly (e.g., show an error message)
      console.log("Friendship does not exist.");
      return;
    }

    // Delete each friendship document found in the query
    const deletePromises = friendshipQuery.docs.map((doc) => doc.ref.delete());
    await Promise.all(deletePromises);

    console.log("Friend removed successfully.");
  } catch (error) {
    console.error("Error removing friend:", error);
  }
}

async function getUserFriendsWithUserData(firebaseId) {
  try {
    // Fetch the user's friends from Firebase (replace this with your actual Firebase code)
    const friendsSnapshot = await firebase.firestore()
      .collection('friends')
      .where('user1', '==', firebaseId)
      .get();

    // Fetch the user's data from the users collection
    const userSnapshot = await firebase.firestore()
      .collection('users')
      .doc(firebaseId)
      .get();

    const friends = friendsSnapshot.docs.map((doc) => doc.data().user2);
    const userData = userSnapshot.data(); // User's data from the users collection

    return { friends, userData };
  } catch (error) {
    console.error('Error getting user\'s friends and data:', error);
    return { friends: [], userData: null }; // Return empty array and null user data in case of an error
  }
}
	  
async function countDocumentsWithQuizCodeAndUserID(quizCode, userID) {
  try {
const db = firebase.firestore();

	  const quizReviewDataRef = db.collection('quizReviewData');
    const snapshot = await quizReviewDataRef
      .where('quizCode', '==', quizCode)
      .where('userID', '==', userID)
      .get();

    return snapshot.size;
  } catch (error) {
    console.error('Error counting documents:', error);
    return 0;
  }
}


	  
     (adsbygoogle = window.adsbygoogle || []).push({});

</script>


	  <script src="script.js" defer></script>


 </body>
	
</html>


